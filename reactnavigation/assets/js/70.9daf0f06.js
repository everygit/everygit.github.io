(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{424:function(t,s,a){"use strict";a.r(s);var n=a(45),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"自定义-android-返回按钮行为"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义-android-返回按钮行为"}},[t._v("#")]),t._v(" 自定义 Android 返回按钮行为")]),t._v(" "),a("p",[t._v("默认情况下，当用户按下 Android 硬件返回按钮时，react-navigation 将 pop 屏幕或退出应用程序，如果没有屏幕 pop。这是一个合理的默认行为，但在某些情况下，您可能希望实现自定义处理。")]),t._v(" "),a("p",[t._v("例如，考虑一个用户在项目选择列表的屏幕中，此时 “选择模式” 处于活动状态。在按下返回按钮时，你会首先想要取消 “选择模式”，屏幕应该只有在按下第二个返回按钮时才弹出。下面的代码片段演示了这种情况。我们使用了 react-native 自带的 "),a("code",[t._v("BackHandler")]),t._v("，以及 "),a("code",[t._v("useFocusEffect")]),t._v(" hook 来添加我们的自定义 "),a("code",[t._v("hardwareBackPress")]),t._v(" 侦听器。")]),t._v(" "),a("p",[t._v("从 "),a("code",[t._v("onBackPress")]),t._v(" 返回 "),a("code",[t._v("true")]),t._v(" 表示我们已经处理了事件，而 react-navigation 的监听器将不会被调用，因此不会弹出屏幕。返回 "),a("code",[t._v("false")]),t._v(" 将导致事件冒泡，反应导航的侦听器将弹出屏幕。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ScreenWithCustomBackBehavior")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useFocusEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useCallback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onBackPress")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isSelectionModeEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("disableSelectionMode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      BackHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hardwareBackPress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onBackPress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n        BackHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hardwareBackPress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onBackPress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("isSelectionModeEnabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" disableSelectionMode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("所介绍的方法对于在 "),a("code",[t._v("StackNavigator")]),t._v(" 中显示的屏幕将非常有效。目前可能不支持在其他情况下进行自定义后退按钮处理（例如，一种不可行的已知情况是您要在打开的抽屉中处理后退按钮按下操作。欢迎使用此类用例的 PRs）。")]),t._v(" "),a("p",[t._v("如果你不想重写系统返回按钮，而是想阻止从屏幕返回，请参阅 docs 来 "),a("a",{attrs:{href:"https://reactnavigation.org/docs/preventing-going-back",target:"_blank",rel:"noopener noreferrer"}},[t._v("防止返回"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"为什么不使用组件生命周期方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么不使用组件生命周期方法"}},[t._v("#")]),t._v(" 为什么不使用组件生命周期方法")]),t._v(" "),a("p",[t._v("最初，您可能倾向于使用 "),a("code",[t._v("componentDidMount")]),t._v(" 来订阅后按事件，并使用 "),a("code",[t._v("componentWillUnmount")]),t._v(" 来取消订阅，或者使用 "),a("code",[t._v("useEffect")]),t._v(" 来添加侦听器。 这种方法行不通 - 在导航生命周期中了解有关此方法的更多信息。")])])}),[],!1,null,null,null);s.default=e.exports}}]);