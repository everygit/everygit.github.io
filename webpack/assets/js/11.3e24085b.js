(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{363:function(t,a,s){"use strict";s.r(a);var n=s(42),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"插件开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件开发"}},[t._v("#")]),t._v(" 插件开发")]),t._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[t._v("插件向第三方开发者提供了 webpack 引擎中完整的能力。使用阶段式的构建回调，开发者可以引入它们自己的行为到 webpack 构建流程中。创建插件比创建 loader 更加高级，因为你将需要理解一些 webpack 底层的内部特性来做相应的钩子，所以做好阅读一些源码的准备！")]),t._v(" "),s("h2",{attrs:{id:"简单的例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单的例子"}},[t._v("#")]),t._v(" 简单的例子")]),t._v(" "),s("p",[t._v("一个简单的例子，在 "),s("code",[t._v("run")]),t._v(" 和 "),s("code",[t._v("done")]),t._v(" 两个生存周期中输出日志。")]),t._v(" "),s("h3",{attrs:{id:"插件的开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件的开发"}},[t._v("#")]),t._v(" 插件的开发")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// plugins/test.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pluginName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ConsolePlugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("ConsolePlugin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ConsolePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'初始化插件'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsolePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("apply")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("compiler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    compiler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pluginName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("c")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack 构建过程开始"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    compiler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("done"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pluginName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("stats")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ConsolePlugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"插件的引用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件的引用"}},[t._v("#")]),t._v(" 插件的引用")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack.config.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ConsolePlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../plugins/test'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsolePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"compiler-和-compilation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compiler-和-compilation"}},[t._v("#")]),t._v(" Compiler 和 Compilation")]),t._v(" "),s("h3",{attrs:{id:"compiler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compiler"}},[t._v("#")]),t._v(" Compiler")]),t._v(" "),s("p",[t._v("对象代表了完整的 webpack 环境配置。这个对象在启动 webpack 时被一次性建立，并配置好所有可操作的设置，包括 options，loader 和 plugin。")]),t._v(" "),s("h3",{attrs:{id:"compilation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compilation"}},[t._v("#")]),t._v(" Compilation")]),t._v(" "),s("p",[t._v("对象代表了一次资源版本构建。当运行 webpack 开发环境中间件时，每当检测到一个文件变化，就会创建一个新的 compilation，从而生成一组新的编译资源。一个 compilation 对象表现了当前的模块资源、编译生成资源、变化的文件、以及被跟踪依赖的状态信息。compilation 对象也提供了很多关键时机的回调，以供插件做自定义处理时选择使用。")]),t._v(" "),s("h2",{attrs:{id:"插件类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件类型"}},[t._v("#")]),t._v(" 插件类型")]),t._v(" "),s("p",[t._v("基于 tapable 库，可以仔细阅读一番。")]),t._v(" "),s("h3",{attrs:{id:"同步-synchook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#同步-synchook"}},[t._v("#")]),t._v(" 同步 SyncHook")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("new SyncHook([params])")]),t._v(" 声明， 使用 "),s("code",[t._v("tap")]),t._v(" 来绑定")]),t._v(" "),s("h3",{attrs:{id:"同步-bail-hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#同步-bail-hooks"}},[t._v("#")]),t._v(" 同步 Bail Hooks")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("SyncBailHook[params]")]),t._v(" 声明， 使用 "),s("code",[t._v("tap")]),t._v(" 来绑定")]),t._v(" "),s("blockquote",[s("p",[t._v("如果返回值不是 "),s("code",[t._v("undefined")]),t._v(" 就不会继续向下执行其他的钩子方法")])]),t._v(" "),s("h3",{attrs:{id:"同步-waterfall-hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#同步-waterfall-hooks"}},[t._v("#")]),t._v(" 同步 Waterfall Hooks")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("SyncWaterfallHook[params]")]),t._v(" 声明， 使用 "),s("code",[t._v("tap")]),t._v(" 来绑定")]),t._v(" "),s("blockquote",[s("p",[t._v("前一个插件执行完成后，返回值作为参数，执行下一个插件")])]),t._v(" "),s("h3",{attrs:{id:"异步-async-series-hook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#异步-async-series-hook"}},[t._v("#")]),t._v(" 异步 Async Series Hook")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("AsyncSeriesHook[params]")]),t._v(" 声明， 使用 "),s("code",[t._v("tap")]),t._v(" / "),s("code",[t._v("tapAsync")]),t._v(" / "),s("code",[t._v("tapPromise")]),t._v(" 来绑定")]),t._v(" "),s("h3",{attrs:{id:"异步-async-waterfall"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#异步-async-waterfall"}},[t._v("#")]),t._v(" 异步 Async waterfall")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("AsyncWaterfallHook[params]")]),t._v(" 声明， 使用 "),s("code",[t._v("tap")]),t._v(" / "),s("code",[t._v("tapAsync")]),t._v(" / "),s("code",[t._v("tapPromise")]),t._v(" 来绑定")]),t._v(" "),s("h3",{attrs:{id:"异步-async-series-bail"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#异步-async-series-bail"}},[t._v("#")]),t._v(" 异步 Async Series Bail")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("AsyncSeriesBailHook[params]")]),t._v(" 声明， 使用 "),s("code",[t._v("tap")]),t._v(" / "),s("code",[t._v("tapAsync")]),t._v(" / "),s("code",[t._v("tapPromise")]),t._v(" 来绑定")]),t._v(" "),s("h3",{attrs:{id:"异步-async-parallel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#异步-async-parallel"}},[t._v("#")]),t._v(" 异步 Async Parallel")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("AsyncParallelHook[params]")]),t._v(" 声明， 使用 "),s("code",[t._v("tap")]),t._v(" / "),s("code",[t._v("tapAsync")]),t._v(" / "),s("code",[t._v("tapPromise")]),t._v(" 来绑定")])])}),[],!1,null,null,null);a.default=e.exports}}]);