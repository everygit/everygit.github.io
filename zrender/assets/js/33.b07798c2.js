(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{385:function(s,t,a){"use strict";a.r(t);var e=a(43),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"准备工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[s._v("#")]),s._v(" 准备工作")]),s._v(" "),a("h2",{attrs:{id:"选定版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选定版本"}},[s._v("#")]),s._v(" 选定版本")]),s._v(" "),a("p",[s._v("当时下载的最新版本，应该是 "),a("code",[s._v("4.3.0")]),s._v(" 以上的版本, 具体 git 提交的 "),a("strong",[s._v("ID")]),s._v(" "),a("code",[s._v("41d902816d9b934eae6e2c846afce5ef54974502")])]),s._v(" "),a("h2",{attrs:{id:"克隆版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#克隆版本"}},[s._v("#")]),s._v(" 克隆版本")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("git clone https://github.com/ecomfe/zrender.git\n")])])]),a("p",[s._v("如果版本相差太大的话，建议检出 "),a("code",[s._v("41d902816d9b934eae6e2c846afce5ef54974502")]),s._v(" 版本")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("git checkout 41d902816d9b934eae6e2c846afce5ef54974502\n")])])]),a("h2",{attrs:{id:"安装依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[s._v("#")]),s._v(" 安装依赖")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),a("p",[s._v("or")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v("\n")])])]),a("h2",{attrs:{id:"执行-npm-脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行-npm-脚本"}},[s._v("#")]),s._v(" 执行 npm 脚本")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"prepublish"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node build/build.js --prepublish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node build/build.js --release"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node build/build.js --watch"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node build/build.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./node_modules/.bin/eslint src"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h2",{attrs:{id:"编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译"}},[s._v("#")]),s._v(" 编译")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm run build\n")])])]),a("p",[s._v("生成 "),a("code",[s._v("<dist>")]),s._v(" 目录、 "),a("code",[s._v("<lib>")]),s._v(" 目录、  "),a("code",[s._v("index.js")]),s._v(" 文件")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("<dist>")]),s._v(" 目录中包含 "),a("code",[s._v("zrender.js")]),s._v(" "),a("code",[s._v("zrender.js.map")]),s._v(" "),a("code",[s._v("zrender.min.js")]),s._v(", iife 格式")]),s._v(" "),a("li",[a("code",[s._v("<lib>")]),s._v(" 目录中包含 zrender 的各个模块，amd格式")])]),s._v(" "),a("p",[s._v("zrender 使用 rollup 打包，生成包的格式如下：")]),s._v(" "),a("st-quote",[a("ol",[a("li",[s._v("amd -- 异步模块定义，用于像RequestJS这样的模块加载器。")]),s._v(" "),a("li",[s._v("cjs -- CommonJS, 适用于Node或Browserify/webpack")]),s._v(" "),a("li",[s._v("es -- 将软件包保存为ES模块文件。")]),s._v(" "),a("li",[s._v("iife -- 一个自动执行的功能，适合作为 "),a("code",[s._v("<script>")]),s._v(" 标签这样的。")]),s._v(" "),a("li",[s._v("umd -- 通用模块定义，以amd, cjs, 和 iife 为一体。")])])]),s._v(" "),a("h2",{attrs:{id:"目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[s._v("#")]),s._v(" 目录结构")]),s._v(" "),a("p",[s._v("主要的目录结构，其他的删除掉了")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("├── build (编译相关)\n├── dist (编译生成的文件, iife)\n├── lib (编译生成的文件，AMD)\n├── index.js (库的入口)\n├── package.json (项目配置文件)\n├── src (源文件)\n├── test (实例文件)\n└── zrender.all.js (编译入口文件)\n")])])]),a("h3",{attrs:{id:"build"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[s._v("#")]),s._v(" build")]),s._v(" "),a("h4",{attrs:{id:"build-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-js"}},[s._v("#")]),s._v(" build.js")]),s._v(" "),a("p",[s._v("用于编译，使用 "),a("code",[s._v("commander")]),s._v(" 来做命令行界面的整解决方案, 以 "),a("code",[s._v("zrender.all.js")]),s._v(" 为入口，根据参数来选择编译还是监听模式。")]),s._v(" "),a("p",[s._v("相关链接：")]),s._v(" "),a("blockquote",[a("p",[s._v("commander: "),a("a",{attrs:{href:"https://www.npmjs.com/package/commander",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.npmjs.com/package/commander"),a("OutboundLink")],1)])]),s._v(" "),a("h3",{attrs:{id:"src"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#src"}},[s._v("#")]),s._v(" src")]),s._v(" "),a("p",[s._v("zrender 的源代码")]),s._v(" "),a("h3",{attrs:{id:"zrender-all-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zrender-all-js"}},[s._v("#")]),s._v(" zrender.all.js")]),s._v(" "),a("p",[s._v("编译的入口文件")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/zrender'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/export'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/svg/svg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/vml/vml'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])],1)}),[],!1,null,null,null);t.default=r.exports}}]);